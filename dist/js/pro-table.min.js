!function(t){var e={};function s(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=t,s.c=e,s.d=function(t,e,o){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(s.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)s.d(o,i,function(e){return t[e]}.bind(null,i));return o},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=0)}([function(t,e,s){"use strict";s.r(e),s.d(e,"fromArray",(function(){return b})),s.d(e,"fromTable",(function(){return $})),s.d(e,"ProTable",(function(){return m}));var o=class{constructor({key:t,child:e,options:s}){this.key=t,e instanceof Node?this.buildDOMFromNode(e):this.buildDOMFromString(e),this.options={attrs:{colspan:1},style:{},...s};for(const t in this.options.attrs)this.$dom.setAttribute(t,this.options.attrs[t]);for(const t in this.options.style)this.$dom.style[t]=this.options.style[t]}buildDOMFromString(t){this.$dom=document.createElement("td"),this.$dom.innerHTML=t||"-"}buildDOMFromNode(t){this.$dom=document.createElement("td"),this.$dom.appendChild(t)}};var i=class{constructor({key:t,proTable:e,options:s}){this.key=t,this.proTable=e,this.$dom=document.createElement("th"),this.options={attrs:{colspan:1},orderabel:!0,...s},this._createContainer(),this._createSpan(),this._applyAttributes(),this._applyClasses(),this._applyOrderable()}_createContainer(){this.$container=document.createElement("div"),this.$container.style.display="flex",this.$container.style.justifyContent="space-between",this.$container.style.alignItems="center",this.$dom.appendChild(this.$container)}_applyAttributes(){for(const t in this.options.attrs)this.$dom.setAttribute(t,this.options.attrs[t])}_applyClasses(){this.options.classes&&this.options.classes.forEach(t=>this.$dom.classList.add(t))}_createSpan(){this.$spanLabel=document.createElement("span"),this.$spanLabel.innerHTML=`${this.key[0].toUpperCase()}${this.key.toLowerCase().substr(1)}`||"-",this.$container.appendChild(this.$spanLabel)}_isOrderable(){return this.options.orderabel&&1===this.options.attrs.colspan}_applyOrderable(){this._isOrderable()&&(this.$container.style.cursor="pointer",this.$spanTop=document.createElement("span"),this.$spanTop.innerHTML="&#9652;",this.$spanTop.style.marginBottom="-4px",this.$spanBottom=document.createElement("span"),this.$spanBottom.innerHTML="&#9662;",this.$spanBottom.style.marginTop="-4px",this.$orderDom=document.createElement("div"),this.$orderDom.appendChild(this.$spanTop),this.$orderDom.appendChild(this.$spanBottom),this.$orderDom.style.display="inline-flex",this.$orderDom.style.flexDirection="column",this.$orderDom.style.justifyContent="center",this.$orderDom.style.fontSize="70%",this.$orderDom.style.height="20px",this.$orderDom.style.opacity=.3,this.$container.appendChild(this.$orderDom),this.$dom.addEventListener("click",t=>{this._toggleOrder()}))}_toggleOrder(){const t=this.proTable.options.order;let e={key:this.key,direction:"asc"};t.key===this.key&&(e.direction="desc"===t.direction?"asc":"desc"),this.proTable.setOrder(e)}render(){if(this._isOrderable()){const t=this.proTable.options.order;this.$spanTop.style.visibility=t.key===this.key&&"desc"===t.direction?"hidden":"",this.$spanBottom.style.visibility=t.key===this.key&&"asc"===t.direction?"hidden":""}}};var r=class{constructor(){this.$dom=document.createElement("tr"),this.childs=[]}addTd({key:t,label:e}){const s=new o({key:t,child:e});this.childs.push(s),this.$dom.appendChild(s.$dom)}pushTd(t){this.childs.push(t),this.$dom.appendChild(t.$dom)}addTds(t){return t.forEach(t=>{this.addTd(t)}),this}addTh(t,e){const s=new i(t,e);this.childs.push(s),this.$dom.appendChild(s.$dom)}pushTh(t){this.childs.push(t),this.$dom.appendChild(t.$dom)}addThs(t){return t.forEach(t=>{this.addTh(t)}),this}};class n{constructor({columns:t,proTable:e,options:s}){this.options={thClasses:[],...s},this.proTable=e,this.$dom=document.createElement("thead"),this.trs=this.generateTrs(t),this.columnsCount=(()=>this.trs[0].childs.map(t=>t.options.attrs.colspan).reduce((t,e)=>t+e))(),console.log("trs",this.trs),this.columns=t,this.trs.forEach(t=>this.$dom.appendChild(t.$dom))}generateTrs(t){let e=[],{ths:s,childs:o}=this.generateThs(t),i=new r;return s.forEach(t=>i.pushTh(t)),e.push(i),o.length&&(e=e.concat(this.generateTrs(o))),i.childs.forEach(t=>{1===t.options.attrs.colspan&&t.$dom.setAttribute("rowspan",e.length)}),e}generateThs(t){let e=[],s=[];return t.forEach(t=>{if(null!==t&&t.constructor===Object){const o=Object.keys(t)[0];e.push(new i({key:o,proTable:this.proTable,options:{attrs:{colspan:this.getColspan(t[o])},classes:this.options.thClasses}})),s=s.concat(t[o])}else e.push(new i({key:t,proTable:this.proTable,options:{classes:this.options.thClasses}}))}),{ths:e,childs:s}}getColspan(t){let e=t.length;return t.forEach(t=>{null!==t&&t.constructor===Object&&(e+=this.getColspan(t[Object.keys(t)[0]])-1)}),e}render(){this.trs.forEach(t=>{t.childs.forEach(t=>t.render())})}}var a=class{constructor(t){this.$dom=document.createElement("tbody"),this.proTable=t,this.trs=this.generateTrs(this.proTable.columns,this.proTable.rows),console.log(this.trs),console.log("TBody","constructor"),this.render()}generateTrs(t,e){const s=[];return e.forEach(e=>{const o=new r;o.addTds(this.generateTds(t,e)),s.push(o)}),s}generateTds(t,e){let s=[];return t.forEach(t=>{null!==t&&t.constructor===Object?s=s.concat(this.generateTds(Object.values(t)[0],e[Object.keys(t)[0]])):s.push({key:t,label:e[t]})}),console.log("generateTds",s),s}render(){for(;this.$dom.lastChild;)this.$dom.removeChild(this.$dom.lastChild);const t=this.proTable.options.limit,e=this.proTable.options.page,s=(e-1)*t;if(this.filteredTrs.sort(this._sort.bind(this)).slice(s,this.proTable.options.limit*e).forEach(t=>this.$dom.appendChild(t.$dom)),this.filteredTrs.length<1&&this.proTable.options.keyword){const t=new r,e=new o({child:"Not matching records found",options:{attrs:{colspan:this.proTable.thead.columnsCount},style:{textAlign:"center"}}});t.pushTd(e),this.$dom.appendChild(t.$dom)}}get filteredTrs(){return this.trs.filter(this._filter.bind(this))}_filter(t){const e=this.proTable.options.keyword||"";return!!t.childs.find(t=>t.$dom.innerText.toLowerCase().indexOf(e.toLowerCase())>-1)}_sort(t,e){const s=this.proTable.options.order;if(s.key){const o=t.childs.find(t=>t.key===s.key),i=e.childs.find(t=>t.key===s.key);return"asc"===s.direction?o.$dom.innerText>i.$dom.innerText?1:-1:o.$dom.innerText>i.$dom.innerText?-1:1}return 0}};var h=class{constructor(t){this.proTable=t,this.$dom=document.createElement("div"),this.$dom.style.display="inline-block",this.$dom.style.marginRight="1rem",this._createSpan(),this._createSelect()}_createSpan(){const t=document.createElement("span");t.innerText="Rows per page:",t.style.marginRight="1rem",this.$dom.appendChild(t)}_createSelect(){const t=this.proTable.options.limit;this.$select=document.createElement("select"),[5,10,25,50,100,250,500].forEach(e=>{const s=document.createElement("option");s.value=e,s.innerText=e,s.selected=parseInt(t)===e,this.$select.appendChild(s)}),this.$select.addEventListener("change",t=>{this.proTable.setLimit(this.$select.value)}),this.$dom.appendChild(this.$select)}};var l=class{constructor(t){this.proTable=t,this.$dom=document.createElement("div"),this._createRowsPerPage(),this._createSpan(),this._createPrevButton(),this._createNextButton(),this.render()}_createRowsPerPage(){this.rowsPerPage=new h(this.proTable),this.$dom.appendChild(this.rowsPerPage.$dom)}_createSpan(){this.$span=document.createElement("span"),this.$span.style.marginRight="1rem",this.$dom.appendChild(this.$span)}_createNextButton(){this.$btnNext=document.createElement("button"),this.$btnNext.innerText="Next",this.$btnNext.addEventListener("click",t=>{this.proTable.setPage(this.proTable.options.page+1)}),this.$dom.appendChild(this.$btnNext)}_createPrevButton(){this.$btnPrev=document.createElement("button"),this.$btnPrev.innerText="Prev",this.$dom.appendChild(this.$btnPrev),this.$btnPrev.addEventListener("click",t=>{this.proTable.setPage(this.proTable.options.page-1)})}render(){const t=this.proTable.options.limit,e=this.proTable.options.page,s=(e-1)*t+1,o=s+t-1,i=this.proTable.tbody.filteredTrs.length,r=Math.ceil(i/t);this.$span.innerText=`${s}-${o>i?i:o} of ${i}`,this.$btnPrev.disabled=1===e,this.$btnNext.disabled=e===r}};var d=class{constructor(t){this.proTable=t,this.$dom=document.createElement("tfoot"),this.trs=[],"simple"==this.proTable.options.pagination&&this.createSimplePagination(),this.trs.forEach(t=>this.$dom.appendChild(t.$dom))}createSimplePagination(){if(this.proTable.tbody.trs.length<this.proTable.options.limit)return;this.simplePagination=new l(this.proTable);const t=this.proTable.thead.columnsCount,e=new r,s=new o({child:this.simplePagination.$dom,options:{attrs:{colspan:t},style:{textAlign:"right"}}});e.pushTd(s),this.trs.push(e)}render(){"simple"==this.proTable.options.pagination&&this.simplePagination&&this.simplePagination.render()}};var c=class{constructor({proTable:t}){this.proTable=t,this._createInput()}_createInput(){this.$dom=document.createElement("input"),this.$dom.placeholder="Search",this.$dom.addEventListener("keyup",this._onKeyUp.bind(this))}_onKeyUp(){this.proTable.setKeyword(this.$dom.value)}};var p=class{constructor({proTable:t}){this.proTable=t,this.$dom=document.createElement("header"),this._applyStyles(),this._createSearch()}_applyStyles(){this.$dom.style.textAlign="right"}_createSearch(){this.search=new c({proTable:this.proTable}),this.$dom.appendChild(this.search.$dom)}};var m=class{constructor(t,e){this.elId=t;this.options={classes:[],thead:{},limit:10,page:1,keyword:null,pagination:"simple",order:{key:null,direction:null},...e},this.thead=null,this.tbody=null,this.$dom=document.createElement("section"),this.$dom.classList.add("pro-table")}generateTable({columns:t,rows:e}){this.columns=t,this.rows=e,this.$table=document.createElement("table"),this.$dom.appendChild(this.$table),this._generateHeader(),this._generateThead({columns:t,rows:e}),this._generateTbody(),this._generateTFoot(),this.options.classes&&this.options.classes.forEach(t=>{this.$table.classList.add(t)}),console.log(this.$table)}_generateHeader(){this.header=new p({proTable:this}),this.$dom.prepend(this.header.$dom)}_generateThead({columns:t,rows:e}){this.thead=new n({columns:t,proTable:this,options:this.options.thead}),this.$table.appendChild(this.thead.$dom)}_generateTbody(){this.tbody&&this.$table.removeChild(this.tbody.$dom),this.tbody=new a(this),this.$table.appendChild(this.tbody.$dom)}_generateTFoot(){this.tfoot&&this.$table.removeChild(this.tfoot.$dom),this.tfoot=new d(this),this.$table.appendChild(this.tfoot.$dom)}setKeyword(t){this.options.keyword=t,this.setPage(1)}setPage(t){this.options.page=t,t<1&&(this.options.page=1),this.tbody.render(),this.tfoot.render()}setLimit(t){this.options.page=1,this.options.limit=parseInt(t),this.tbody.render(),this.tfoot.render()}setOrder({key:t,direction:e}){this.options.order={key:t,direction:e},this.thead.render(),this.setPage(1)}draw(){document.querySelector(this.elId).appendChild(this.$dom)}};const u=t=>{const e=[],s=[];return t.forEach(t=>{for(const o in t)e.find(t=>t===o)||(null!==t[o]&&t[o].constructor===Object?s.find(t=>t===o)||(s.push(o),e.push({[o]:u([t[o]])})):e.push(o))}),e};var b=(t,e,s)=>{const o=u(e);console.log("columns",o);const i=new m(t,s);i.generateTable({columns:o,rows:e}),i.draw()};var $=(t,e)=>{const s=document.querySelector(t),o=function(t){const e=t.querySelector("thead tr");return Array.from(e.children).map(t=>t.innerText)}(s),i=function(t,e){const s=t.querySelectorAll("tbody tr");return Array.from(s).map(t=>{const s={};return e.forEach((e,o)=>{s[e]=t.children[o].innerText}),s})}(s,o);console.log("fromTable","dom:",s),console.log("fromTable","columns:",o),console.log("fromTable","rows:",i);const r=new m(null,e);r.generateTable({columns:o,rows:i}),console.log("fromTable","proTable:",r.$dom),s.replaceWith(r.$dom)};e.default={fromArray:b,ProTable:m}}]);
//# sourceMappingURL=pro-table.min.js.map